{% extends "base.stencil" %}

{% block title %}{{ block.super }} - Berichten{% endblock %}

{% block content %}
<h2>Berichten</h2>
<p>
    Op deze pagina verschijnen de berichten die je verstuurt of ontvangt.
    Deze berichten verdwijnen automatisch van zodra het spel waarover ze gaan is afgelopen.
</p>
{% if conversations %}
    {% for conversation in conversations %}
        <!-- Header -->
        <a class="media mt-3" href="/web/activity/{{ conversation.activity }}">
            <img class="mr-3" width="75px" src="{{ conversation.picture }}">
            <div class="media-body">
                <h5>{{ conversation.title }}</h5>
                <p>{{ conversation.other.name }}</p>
                {% for message in conversation.messages %}
                    <!-- Nested messages for md -->
                    <div class="media d-none d-md-flex mt-3">
                        <!-- Message from the other user -->
                        {% if conversation.userIsSender and message.direction == "incoming" or 
                           not conversation.userIsSender and message.direction == "outgoing" %}
                            <img class="avatar rounded-circle mr-3" src="{{ conversation.other.picture }}" title="{{ conversation.other.name }}">
                            <div class="media-body">
                                <h6 class="text-muted">
                                    {{ message.longDate }} om {{ message.time }}
                                    {% if not message.isRead %}
                                        <i class="fa fa-asterisk text-danger"></i>
                                    {% endif %}
                                </h6>
                                {{ message.text }}
                            </div>
                        <!-- Message from the current user -->
                        {% else %}
                            <img class="avatar rounded-circle mr-3" src="{{ base.user.picture }}" title="{{ base.user.name }}">
                            <div class="media-body">
                                <h6 class="text-muted">
                                    {{ message.longDate }} om {{ message.time }}
                                </h6>
                                {{ message.text }}
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}
                <!-- <form class="d-none d-md-flex mt-3" method="post">
                    <div class="form-group w-100">
                        <div class="input-group">
                            <input class="form-control" type="text" name="reply" placeholder="Verstuur een reactie">
                            <div class="input-group-append">
                                <button class="btn btn-secondary" type="button">
                                    <i class="fa fa-reply"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </form> -->
            </div>
        </a>
        <!-- Collapsed messages for xs and sm -->
        {% for message in conversation.messages %}
            <div class="media d-md-none mt-3">
                <!-- Message from the other user -->
                {% if conversation.userIsSender and message.direction == "incoming" or 
                   not conversation.userIsSender and message.direction == "outgoing" %}
                    <img class="avatar rounded-circle mr-3" src="{{ conversation.other.picture }}" title="{{ conversation.other.name }}">
                    <div class="media-body">
                        <h6 class="text-muted">
                            <!-- xs shows abbreviated weekday -->
                            <span class="d-sm-none">{{ message.shortDate }}</span>
                            <!-- sm shows the full weekday -->
                            <span class="d-none d-sm-inline">{{ message.longDate }}</span>
                            om {{ message.time }}
                            {% if not message.isRead %}
                                <i class="fa fa-asterisk text-danger"></i>
                            {% endif %}
                        </h6>
                        {{ message.text }}
                    </div>
                <!-- Message from the current user -->
                {% else %}
                    <img class="avatar rounded-circle mr-3" src="{{ base.user.picture }}" title="{{ base.user.name }}">
                    <div class="media-body">
                        <h6 class="text-muted">
                            <!-- xs shows abbreviated weekday -->
                            <span class="d-sm-none">{{ message.shortDate }}</span>
                            <!-- sm shows the full weekday -->
                            <span class="d-none d-sm-inline">{{ message.longDate }}</span>
                            om {{ message.time }}
                        </h6>
                        {{ message.text }}
                    </div>
                {% endif %}
            </div>
        {% endfor %}
        <!-- <form class="d-md-none mt-3" method="post">
            <div class="form-group">
                <div class="input-group">
                    <input class="form-control" type="text" name="reply" placeholder="Verstuur een reactie">
                    <div class="input-group-append">
                        <button class="btn btn-secondary" type="button">
                            <i class="fa fa-reply"></i>
                        </button>
                    </div>
                </div>
            </div>
        </form> -->
    {% endfor %}
{% else %}
    <p>Je hebt momenteel geen berichten.</p>
{% endif %}
{% endblock %}
